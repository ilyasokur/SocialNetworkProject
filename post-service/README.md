# Post Service

**Технологии**: Python (FastAPI), PostgreSQL  
**Назначение**: Управление постами и комментариями в социальной сети.

## Зона ответственности

1. CRUD по постам (создание, чтение, обновление, удаление).
2. CRUD по комментариям (включая вложенные комментарии "reply to comment").
3. Учёт лайков/просмотров на уровне постов (можно хранить счётчики локально).
4. При появлении лайка или просмотра отправляет событие в Kafka для Statistics Service.

## Границы

- Не аутентифицирует пользователей — полагается на User Service (и API Gateway).
- Не подсчитывает глобальную статистику (хранит, возможно, локальный счётчик лайков/просмотров, но агрегированные данные собираются в Statistics Service).
- Не хранит данных о пользователях (только `user_id` как внешний ключ).

## Данные

- **База данных**: PostgreSQL (своя база/схема).
- Основные таблицы (подробности — [ER-диаграмма](../docs/er_post_service.md)):
  - `POSTS` (содержит `id`, `user_id`, текст поста, счётчики).
  - `COMMENTS` (содержит `id`, `post_id`, `user_id`, текст комментария, родительский комментарий для вложенности).
  - `POST_MEDIA` (если храните ссылки на изображения/видео, либо другие вложения).

## Основные интеграции

- **API Gateway**: Все запросы на создание/чтение/редактирование постов и комментариев приходят через него.
- **Kafka**: Публикует события о новых комментариях, лайках, просмотрах. Statistics Service подписывается на них.
- **User Service**: При необходимости (например, валидация user_id), может получать данные о пользователе, но обычно это делает Gateway.